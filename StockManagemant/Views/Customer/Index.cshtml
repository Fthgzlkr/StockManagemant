@{
    ViewData["Title"] = "MÃ¼ÅŸteri YÃ¶netimi";
    Layout = "_Layout";
}
<link rel="stylesheet" href="~/css/Product.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/GlobalStyles.css" asp-append-version="true" />
<link rel="stylesheet" href="~/css/Site.css" asp-append-version="true" />

<h2 class="mt-4 mb-3">ðŸ‘¤ MÃ¼ÅŸteri YÃ¶netimi</h2>

<div class="table-container mt-3">
    <table id="customerGrid"></table>
    <div id="pager"></div>

    <div class="text-end mt-3">
        <button id="addCustomerBtn" class="btn btn-success">
            <i class="bi bi-plus-lg me-1"></i> MÃ¼ÅŸteri Ekle
        </button>
    </div>
</div>


<script>
    $(document).ready(function () {
        $("#customerGrid").jqGrid({
            url: '/Customer/GetCustomers',
            datatype: "json",
            mtype: "GET",
            colNames: ['ID', 'MÃ¼ÅŸteri AdÄ±', 'Telefon', 'Email', 'Adres', 'Ä°ÅŸlemler'],
            colModel: [
                { name: 'id', index: 'id', key: true, hidden: true },
                { name: 'name', index: 'name', sortable: true },
                { name: 'phone', index: 'phone', sortable: true },
                { name: 'email', index: 'email', sortable: true },
                { name: 'address', index: 'address', sortable: true },
                {
                    name: "actions",
                    align: "center",
                    formatter: function (cellvalue, options, rowObject) {
                        return `
                            <div class="action-icons">
                                <i class="fa-solid fa-pen text-primary fa-xl editCustomerBtn" data-id="${rowObject.id}" title="DÃ¼zenle"></i>
                                <i class="fa-solid fa-trash text-danger fa-xl deleteCustomerBtn" data-id="${rowObject.id}" title="Sil"></i>
                            </div>
                        `;
                    }
                }
            ],
            pager: '#pager',
            rowNum: 10,
            rowList: [10, 20, 30],
            sortname: 'id',
            sortorder: 'desc',
            viewrecords: true,
            height: 'auto',
            autowidth: true,
            shrinkToFit: true,
            guiStyle: "bootstrap4",
            caption: "MÃ¼ÅŸteri Listesi",
            jsonReader: {
                root: "rows",
                page: "page",
                total: "total",
                records: "records"
            }
        });

        // MÃ¼ÅŸteri Ekle
       

        // Silme
        $(document).on("click", ".deleteCustomerBtn", function () {
            const id = $(this).data("id");
            Swal.fire({
                title: "Emin misiniz?",
                text: "Bu mÃ¼ÅŸteriyi silmek istiyor musunuz?",
                icon: "warning",
                showCancelButton: true,
                confirmButtonText: "Evet, Sil",
                cancelButtonText: "Ä°ptal"
            }).then((result) => {
                if (result.isConfirmed) {
                    $.post(`/Customer/Delete/${id}`, function (response) {
                        if (response.success) {
                            Swal.fire("BaÅŸarÄ±lÄ±", response.message, "success");
                            $("#customerGrid").trigger("reloadGrid");
                        } else {
                            Swal.fire("Hata", response.message, "error");
                        }
                    });
                }
            });
        });

    });

    
</script>
